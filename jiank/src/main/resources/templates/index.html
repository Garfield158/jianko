<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link href="/css/bootstrap.min.css">
    <script type="text/javascript" src="/js/bootstrap.js"></script>
    <script src="https://open.ys7.com/sdk/js/1.4/ezuikit.js"></script>
    <script type="text/javascript" src="/js/jquery-3.3.1.min.js"></script>
    <script src="https://open.ys7.com/sdk/js/1.3/ezuikit.js"></script>

    <style type="text/css">
        .left{
            margin-left:20px;margin-right:10px;background: #71dd8a;width: 300px;height: 300px;float: left
        }
        .center{
            margin-right:20px;margin-left: 20px; background: #71dd8a;width: 300px;height: 300px;float: left
        }
        .right{
            margin-left:10px;background: #71dd8a;width: 300px;height: 300px;float: left
        }
        .mt{
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <h2 class="text-lg-center" align="center">监控系统</h2>
    <div id="schoolList"  style="float: left;margin-left: 20px;margin-top: 20px">
    </div>
    <div id="videoList" align="center"  style= "margin-left: 75px; float:left;width: 1000px;height: 400px;border: #1b1e21">
        <video id="myPlayer" poster="" controls playsInline webkit-playsinline autoplay>
            <source src="rtmp://rtmp.open.ys7.com/openlive/f01018a141094b7fa138b9d0b856507b" type="" />
        </video>
    </div>
</div>
</body>
<script type="text/javascript">
    $(function () {
        $.ajax({
            url:"res/School/getAll",
            method:"post",
            success:function (data) {
                var da=data.data;
                var schoolList=$("#schoolList");
                for (var key in da) {
                    var val=da[key].schoolName;
                    var id=da[key].id;
                    schoolList.append("<input onclick='getDevice("+id+")' type='button' class='btn-info' value="+val+">").append("</br>")
                }
            }
        })
    });
    function getDevice(id) {
        $.ajax({
                url:"res/dev/getDev",
                method:"post",
                data:"id="+id,
                success:function (msg) {
                    var data=msg.data;
                    var html="";
                    for (var key in data) {
                        var ids=data[key].id;
                        var url = data[key].url;
                        if (key%3==0){
                            html+="<div id='"+ids+"' class='left mt'><img src=\"//img//123.jpg\"><input type='button' class='btn-info' onclick='actionV(\"+"+url+"+\","+ids+")' value='播放'/><input type='button' value='設置'/></div>";
                        }else if (key%3==1) {
                            html+="<div id='"+ids+"' class=\"center mt\"><img src=\"//img//123.jpg\" ><input type='button' class='btn-info' onclick='actionV(\"+"+url+"+\","+ids+")' value='播放'/><input type='button' value='設置'/></div>"
                        }else {
                            html+="<div id='"+ids+"' class='right mt'><img src=\"//img//123.jpg\"><input type='button' class='btn-info' onclick='actionV(\"+"+url+"+\","+ids+")' value='播放'/><input type='button' value='設置'/></div><br>"
                        }
                    }
                    document.getElementById("videoList").innerHTML=html;
                }
            });
    }

    function actionV(url,id) {
        console.info("11234");
        var element = document.getElementById(id);
        element.innerHTML="<video id='"+id+"v' poster='' controls playsInline webkit-playsinline autoplay>\n" +
            "<source src='rtmp://rtmp.open.ys7.com/openlive/f01018a141094b7fa138b9d0b856507b' type='' />\n" +
            "</video>";
        var idstr=id+"v";
        var player = new EZUIPlayer(idstr);
        // var flashvars;
        // flashvars = {
        //     f: url,
        //     c: 1
        // };
        // var params = {bgcolor: '#FFF', allowFullScreen: true, allowScriptAccess: 'always', wmode: 'transparent'};
        // CKobject.embedSWF("./ckplayer/ckplayer.swf", "videoPlay", "video", "100%", "100%", flashvars, params);
    }
    var player = new EZUIPlayer('myPlayer');
</script>
</html>